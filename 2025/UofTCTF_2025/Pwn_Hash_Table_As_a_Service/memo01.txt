pwndbg> vmmap
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
             Start                End Perm     Size Offset File
    0x555555554000     0x555555555000 r--p     1000      0 /home/mito/CTF/UofTCTF_2025/Pwn_Hash_Table_As_a_Service/chall
    0x555555555000     0x555555556000 r-xp     1000   1000 /home/mito/CTF/UofTCTF_2025/Pwn_Hash_Table_As_a_Service/chall
    0x555555556000     0x555555557000 r--p     1000   2000 /home/mito/CTF/UofTCTF_2025/Pwn_Hash_Table_As_a_Service/chall
    0x555555557000     0x555555558000 r--p     1000   2000 /home/mito/CTF/UofTCTF_2025/Pwn_Hash_Table_As_a_Service/chall
    0x555555558000     0x555555559000 rw-p     1000   3000 /home/mito/CTF/UofTCTF_2025/Pwn_Hash_Table_As_a_Service/chall
    0x555555559000     0x55555557a000 rw-p    21000      0 [heap]
    0x7ffff7c00000     0x7ffff7c28000 r--p    28000      0 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7c28000     0x7ffff7db0000 r-xp   188000  28000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7db0000     0x7ffff7dff000 r--p    4f000 1b0000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7dff000     0x7ffff7e03000 r--p     4000 1fe000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7e03000     0x7ffff7e05000 rw-p     2000 202000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7e05000     0x7ffff7e12000 rw-p     d000      0 [anon_7ffff7e05]
    0x7ffff7fa4000     0x7ffff7fa7000 rw-p     3000      0 [anon_7ffff7fa4]
    0x7ffff7fbd000     0x7ffff7fbf000 rw-p     2000      0 [anon_7ffff7fbd]
    0x7ffff7fbf000     0x7ffff7fc3000 r--p     4000      0 [vvar]
    0x7ffff7fc3000     0x7ffff7fc5000 r-xp     2000      0 [vdso]
    0x7ffff7fc5000     0x7ffff7fc6000 r--p     1000      0 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7fc6000     0x7ffff7ff1000 r-xp    2b000   1000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7ff1000     0x7ffff7ffb000 r--p     a000  2c000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7ffb000     0x7ffff7ffd000 r--p     2000  36000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7ffd000     0x7ffff7fff000 rw-p     2000  38000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffffffde000     0x7ffffffff000 rw-p    21000      0 [stack]

. New Hash Table
2. Set
3. Get
4. Exit
> 1
Index: 0
Size: 32
> 2
Index: 0
Key: aaaaaaaaaaa
Value: > That is not an option
> That is not an option
> That is not an option
> 2
Index: 0
Key: 11111
Value: 22222


pwndbg> x/80gx 0x555555558000
0x555555558000:	0x0000000000000000	0x0000555555558008
0x555555558010:	0x0000000000000000	0x0000000000000000
0x555555558020 <stdout@GLIBC_2.2.5>:	0x00007ffff7e045c0	0x0000000000000000
0x555555558030 <stdin@GLIBC_2.2.5>:	0x00007ffff7e038e0	0x0000000000000000
0x555555558040 <hashTables>:	0x0000000000000020	0x00005555555592a0
0x555555558050 <hashTables+16>:	0x0000000000000000	0x0000000000000000
0x555555558060 <hashTables+32>:	0x0000000000000000	0x0000000000000000
0x555555558070 <hashTables+48>:	0x0000000000000000	0x0000000000000000
0x555555558080 <hashTables+64>:	0x0000000000000000	0x0000000000000000
0x555555558090 <hashTables+80>:	0x0000000000000000	0x0000000000000000
0x5555555580a0 <hashTables+96>:	0x0000000000000000	0x0000000000000000
0x5555555580b0 <hashTables+112>:	0x0000000000000000	0x0000000000000000
0x5555555580c0 <hashTables+128>:	0x0000000000000000	0x0000000000000000
0x5555555580d0 <hashTables+144>:	0x0000000000000000	0x0000000000000000
0x5555555580e0 <hashTables+160>:	0x0000000000000000	0x0000000000000000
0x5555555580f0 <hashTables+176>:	0x0000000000000000	0x0000000000000000
0x555555558100 <hashTables+192>:	0x0000000000000000	0x0000000000000000
0x555555558110 <hashTables+208>:	0x0000000000000000	0x0000000000000000
0x555555558120 <hashTables+224>:	0x0000000000000000	0x0000000000000000
0x555555558130 <hashTables+240>:	0x0000000000000000	0x0000000000000000
0x555555558140 <hashTables+256>:	0x0000000000000000	0x0000000000000000
0x555555558150 <hashTables+272>:	0x0000000000000000	0x0000000000000000
0x555555558160 <hashTables+288>:	0x0000000000000000	0x0000000000000000
0x555555558170 <hashTables+304>:	0x0000000000000000	0x0000000000000000
0x555555558180 <empty>:	0x0000000000000000	0x0000000000000000
0x555555558190:	0x0000000000000000	0x0000000000000000

0x555555559280:	0x0000000000000000	0x0000000000000000
0x555555559290:	0x0000000000000000	0x0000000000000191
0x5555555592a0:	0x6161616100000000	0x0000000061616161
0x5555555592b0:	0x0000000000000000	0x0000000000000000
0x5555555592c0:	0x0000000000000000	0x0000000000000000
0x5555555592d0:	0x0000000000000000	0x0000000000000000
0x5555555592e0:	0x0000000000000000	0x0000000000000000
0x5555555592f0:	0x00002b6700000000	0x00000a3232323232
0x555555559300:	0x0000000000000000	0x0000000000000000
0x555555559310:	0x0000000000000000	0x0000000000000000
0x555555559320:	0x0000000000000000	0x0000000000000000
0x555555559330:	0x0000000000000000	0x0000000000000000
0x555555559340:	0x0000000000000000	0x0000000000000000
0x555555559350:	0x0000000000000000	0x0000000000000000
0x555555559360:	0x0000000000000000	0x0000000000000000
0x555555559370:	0x0000000000000000	0x0000000000000000
0x555555559380:	0x0000000000000000	0x0000000000000000
0x555555559390:	0x0000000000000000	0x0000000000000000
0x5555555593a0:	0x0000000000000000	0x0000000000000000
0x5555555593b0:	0x0000000000000000	0x0000000000000000
0x5555555593c0:	0x0000000000000000	0x0000000000000000
0x5555555593d0:	0x0000000000000000	0x0000000000000000
0x5555555593e0:	0x0000000000000000	0x0000000000000000
0x5555555593f0:	0x0000000000000000	0x0000000000000000
0x555555559400:	0x0000000000000000	0x0000000000000000
0x555555559410:	0x0000000000000000	0x0000000000000000
0x555555559420:	0x0000000000000000	0x0000000000020be1
0x555555559430:	0x0000000000000000	0x0000000000000000

mito@mito-virtual-machine:~/CTF/UofTCTF_2025/Pwn_Hash_Table_As_a_Service$ one_gadget libc.so.6 
0x583dc posix_spawn(rsp+0xc, "/bin/sh", 0, rbx, rsp+0x50, environ)
constraints:
  address rsp+0x68 is writable
  rsp & 0xf == 0
  rax == NULL || {"sh", rax, rip+0x17302e, r12, ...} is a valid argv
  rbx == NULL || (u16)[rbx] == NULL

0x583e3 posix_spawn(rsp+0xc, "/bin/sh", 0, rbx, rsp+0x50, environ)
constraints:
  address rsp+0x68 is writable
  rsp & 0xf == 0
  rcx == NULL || {rcx, rax, rip+0x17302e, r12, ...} is a valid argv
  rbx == NULL || (u16)[rbx] == NULL

0xef4ce execve("/bin/sh", rbp-0x50, r12)
constraints:
  address rbp-0x48 is writable
  rbx == NULL || {"/bin/sh", rbx, NULL} is a valid argv
  [r12] == NULL || r12 == NULL || r12 is a valid envp

0xef52b execve("/bin/sh", rbp-0x50, [rbp-0x78])
constraints:
  address rbp-0x50 is writable
  rax == NULL || {"/bin/sh", rax, NULL} is a valid argv
  [[rbp-0x78]] == NULL || [rbp-0x78] == NULL || [rbp-0x78] is a valid envp
